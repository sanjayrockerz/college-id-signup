<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Chat Backend Load Test Report</title>
    <style>
      body { font-family: Arial, sans-serif; background: #0f172a; color: #f8fafc; margin: 0; padding: 2rem; }
      h1, h2 { color: #38bdf8; margin-bottom: 0.25rem; }
      h3 { color: #facc15; margin-bottom: 0.25rem; }
      section { background: rgba(15, 23, 42, 0.75); border: 1px solid #1d4ed8; border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem; }
      dl { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 0.75rem 1.5rem; }
      dt { font-weight: bold; color: #f472b6; }
      dd { margin: 0; color: #e2e8f0; }
      .chart { height: 280px; display: flex; justify-content: center; align-items: center; border: 1px dashed #2563eb; border-radius: 6px; margin-top: 1rem; color: #64748b; }
      .placeholder { font-style: italic; color: #94a3b8; }
      pre { background: rgba(30, 41, 59, 0.85); border: 1px solid #1f2937; border-radius: 6px; padding: 1rem; overflow-x: auto; }
      table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
      th, td { border: 1px solid #334155; padding: 0.5rem 0.75rem; text-align: left; }
      th { background: rgba(51, 65, 85, 0.75); color: #e0f2fe; }
      tr:nth-child(even) { background: rgba(15, 23, 42, 0.6); }
      .status-pass { color: #34d399; font-weight: bold; }
      .status-warn { color: #fbbf24; font-weight: bold; }
      .status-fail { color: #f87171; font-weight: bold; }
    </style>
  </head>
  <body>
    <h1>Chat Backend Load Test Report</h1>
    <p class="placeholder">
      Populate this report after executing the load test. Include screenshots or base64-encoded charts where noted.
    </p>

    <section>
      <h2>Test Metadata</h2>
      <dl>
        <div>
          <dt>Test Date</dt>
          <dd><!-- e.g., 2025-10-21T06:36:46Z --></dd>
        </div>
        <div>
          <dt>Environment</dt>
          <dd><!-- e.g., staging-us-east-1, 4 vCPU, 8 GB RAM --></dd>
        </div>
        <div>
          <dt>Load Tool</dt>
          <dd><!-- e.g., k6 v0.51.0 --></dd>
        </div>
        <div>
          <dt>Build Version</dt>
          <dd><!-- git commit SHA or build artifact identifier --></dd>
        </div>
        <div>
          <dt>Baseline Reference</dt>
          <dd><!-- link or identifier for baseline run --></dd>
        </div>
      </dl>
    </section>

    <section>
      <h2>Scenario Overview</h2>
      <p>Ramp profile: 0 → 50 users (2m), sustain 50 users (5m), spike 50 → 100 (30s), sustain 100 (5m), ramp-down 100 → 0 (2m).</p>
      <table>
        <thead>
          <tr>
            <th>Operation</th>
            <th>Traffic Mix</th>
            <th>Endpoint</th>
            <th>Payload Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Send Message</td>
            <td>70%</td>
            <td>POST /api/v1/chat/conversations/:conversationId/messages</td>
            <td>Randomized conversation IDs, 140 ± 40 char text payloads</td>
          </tr>
          <tr>
            <td>Fetch History</td>
            <td>30%</td>
            <td>GET /api/v1/chat/conversations/:conversationId/messages?limit=20&amp;cursor=...</td>
            <td>Paginates across active conversations with cursor churn</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section>
      <h2>Latency (per Operation)</h2>
      <div class="chart">Insert latency over time chart here (PNG/SVG/base64)</div>
      <table>
        <thead>
          <tr>
            <th>Operation</th>
            <th>p50 (ms)</th>
            <th>p75 (ms)</th>
            <th>p90 (ms)</th>
            <th>p95 (ms)</th>
            <th>p99 (ms)</th>
            <th>SLO Target</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Send Message</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>p95 &lt; 250 ms, p99 &lt; 500 ms</td>
            <td class="status-warn"></td>
          </tr>
          <tr>
            <td>Fetch History</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>p95 &lt; 350 ms, p99 &lt; 600 ms</td>
            <td class="status-warn"></td>
          </tr>
        </tbody>
      </table>
    </section>

    <section>
      <h2>Throughput &amp; Error Rates</h2>
      <div class="chart">Insert requests/sec timeline chart here</div>
      <div class="chart">Insert error rate timeline chart here</div>
      <dl>
        <div>
          <dt>Peak Throughput (req/s)</dt>
          <dd></dd>
        </div>
        <div>
          <dt>Sustained Throughput (req/s)</dt>
          <dd></dd>
        </div>
        <div>
          <dt>Overall Error Rate (%)</dt>
          <dd></dd>
        </div>
        <div>
          <dt>Status Code Distribution</dt>
          <dd>2xx: __, 4xx: __, 5xx: __</dd>
        </div>
      </dl>
    </section>

    <section>
      <h2>System Metrics Summary</h2>
      <table>
        <thead>
          <tr>
            <th>Metric</th>
            <th>Observations</th>
            <th>Peak</th>
            <th>Average</th>
            <th>Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>CPU Utilization</td>
            <td></td>
            <td></td>
            <td></td>
            <td>Document per-core hotspots</td>
          </tr>
          <tr>
            <td>Memory Usage</td>
            <td></td>
            <td></td>
            <td></td>
            <td>Include GC churn if notable</td>
          </tr>
          <tr>
            <td>DB Connections</td>
            <td></td>
            <td></td>
            <td></td>
            <td>Active / Idle / Waiting counts</td>
          </tr>
          <tr>
            <td>Network I/O</td>
            <td></td>
            <td></td>
            <td></td>
            <td>MBps up/down</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section>
      <h2>Key Findings</h2>
      <ol>
        <li><!-- Highlight top observation or bottleneck --></li>
        <li><!-- Note any regressions or risk areas --></li>
        <li><!-- Outline recommended actions --></li>
      </ol>
    </section>

    <section>
      <h2>Attachments &amp; Artefacts</h2>
      <ul>
        <li>Raw load test output: <code>docs/validation/performance-metrics.json</code></li>
        <li>Database analysis: <code>docs/validation/database-audit.md</code></li>
        <li>Comparison dashboard: <code>docs/validation/performance-comparison-dashboard.md</code></li>
        <li>Bottleneck summary: <code>docs/validation/bottleneck-analysis.md</code></li>
      </ul>
    </section>
  </body>
</html>
